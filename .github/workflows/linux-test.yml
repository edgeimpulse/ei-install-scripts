# Use this when testing new linux commands for the one-liner script
name: Linux Split Commands
on:
  push:
    branches:
      - 'linux-test*'
jobs:
  Linux-Step-by-Step:
    runs-on: [ubuntu-latest]
    steps:
      - name: ğŸ‘‰ğŸ½ Download script
        run: |
          curl "https://raw.githubusercontent.com/edgeimpulse/ei-install-scripts/${{ github.ref_name }}/install-linux.sh" --output install.sh
          ls
      - name: ğŸ‘‰ğŸ½ Execute script
        run: |
          bash ./install.sh
      - name: ğŸ‘‰ğŸ½ Delete script
        run: |
          rm ./install.sh
          ls
      - name: ğŸ‘‰ğŸ½ Test uploader
        run: |
          set +e # Ignore Errors
          OUTPUT=$(edge-impulse-uploader --api-key notarealkey --category training path/to/file.wav 2>&1)
          if [ "$OUTPUT" == *"Invalid API key"* ]; then echo "Failed as expected!"; else echo "Test failed!" && exit 1; fi
      - name: ğŸ‘‰ğŸ½ Test serialport
        run: |
          set -e # Throw Errors
          edge-impulse-daemon --version
